angular.module("palladioMetaview",["palladio","palladio.services"]).run(["componentService",function(e){var n=function(e,n){var i="<div data-palladio-metaview></div>";return i};e.register("metaview",n)}]).directive("palladioMetaview",function(e,n,i,t){return{scope:!0,templateUrl:"partials/palladio-metaview-component/template.html",link:{pre:function(e,n){e.fileForArrowIndexChange=null,e.clearArrowEffect=function(){e.fileForArrowIndexChange=null}},post:function(e,l,a){e.metadata=n.getMetadata(),e.files=n.getFiles(),e.links=n.getLinks(),e.maxRecords=d3.max(e.files,function(e){return e.data.length}),e.files.forEach(function(e){e.fields.forEach(function(n){var t=i.parseColumn(n.key,e.data,n.mvDelimiter,n.hierDelimiter,[],n.type);n.uniques=t.uniques,n.uniqueValues=n.uniques.map(function(e){return e.key}),n.uniqueKey&&"number"===n.type&&(n.type="uniqueNumeric"),n.uniqueKey&&"text"===n.type&&(n.type="uniqueText"),2===n.uniques.length&&(n.type="binary0"),n.uniques.length>2&&n.uniques.length<10&&"number"===n.type&&(n.type="ordinalNumeric"),n.uniques.length>2&&n.uniques.length<10&&"text"===n.type&&(n.type="nominalText")})}),e.sortFields=function(n){n.fields.forEach(function(i){e.sortField(i,n)})},e.sortField=function(n,i){switch(i.sortMode){case"Map errors and gaps":n.sortedValues=i.data.map(function(e){return e[n.key]}).map(function(i){return{value:i,color:e.colorCalc(i,"error",n)}});break;case"Map by data types":n.sortedValues=i.data.map(function(e){return e[n.key]}).map(function(i){return{value:i,color:e.colorCalc(i,"type",n)}});break;case"Sort by values":n.sortedValues=i.data.map(function(e){return e[n.key]}).map(function(i){return{value:i,color:e.colorCalc(i,"type",n)}}).sort(function(e,n){return e.color<n.color?-1:1})}},e.colors={uniqueNumeric:"#E0CD29",uniqueText:"#E07129",numeric:"#BBAA1B",number:"#BBAA1B",text:"#BB5A1B",binary0:"#9988C0",binary1:"#CD88BD",ordinalNumeric:"#767A79",nominalText:"#53585F",coordinates:"#A1C088",latlong:"#A1C088",date:"#577AA4",YYYYMMDD:"#577AA4",YYYYMM:"#88A1C0",YYYY:"#A9BBD2",url:"#C0A788","null":"#FFFFFF",mismatch:"#EC5D57"},e.textColors={uniqueNumeric:"#FFFFFF",uniqueText:"#FFFFFF",numeric:"#FFFFFF",number:"#FFFFFF",text:"#FFFFFF",binary0:"#FFFFFF",binary1:"#FFFFFF",ordinalNumeric:"#FFFFFF",nominalText:"#FFFFFF",coordinates:"#FFFFFF",latlong:"#FFFFFF",date:"#FFFFFF",YYYYMMDD:"#FFFFFF",YYYYMM:"#FFFFFF",YYYY:"#FFFFFF",url:"#FFFFFF","null":"#444444",mismatch:"#FFFFFF"},e.typeTexts={uniqueNumeric:"Unique Numeric",uniqueText:"Unique Text",numeric:"Numeric",number:"Numeric",text:"Text",binary0:"Binary",binary1:"Binary",ordinalNumeric:"Ordinal Numeric (<10 values)",nominalText:"Nominal Text (<10 values)",coordinates:"Coordinates",latlong:"Coordinates",date:"Date",YYYYMMDD:"Date (YYYY-MM-DD)",YYYYMM:"Date (YYYY-MM)",YYYY:"Date (YYYY)",url:"URL","null":"not defined",mismatch:"match error"},setTimeout(function(){angular.element(l[0]).find("div.dimension-type").tooltip()},100),e.centerTable=function(e){function n(){var n=e.currentTarget.parentNode.parentNode.parentNode;n.parentNode.scrollLeft=n.parentNode.scrollLeft-30+n.getBoundingClientRect().left}setTimeout(n)},e.calcPosition=function(e){return $(".table-display")[0].getBoundingClientRect().left<0?"absolute":"relative"},e.calcTop=function(e){return $("body")[0].getBoundingClientRect().top},$("#tables").scroll(function(){e.$digest()}),e.colorCalc=function(n,i,t){return"error"===i?null===n||void 0===n||""===n?e.colors["null"]:g(n)===t.type||"number"===g(n)&&("uniqueNumeric"===t.type||"ordinalNumeric"===t.type)||"text"===g(n)&&("uniqueText"===t.type||"nominalText"===t.type)||"text"===g(n)&&"uniqueText"===t.type||(4===n.length||7===n.length)&&"date"===t.type||"binary0"===t.type?"#bbbbbb":e.colors.mismatch:"edit"===i?g(n)===t.type||"number"===g(n)&&("uniqueNumeric"===t.type||"ordinalNumeric"===t.type)||"text"===g(n)&&("uniqueText"===t.type||"nominalText"===t.type)||"text"===g(n)&&"uniqueText"===t.type||"binary0"===t.type?"#bbbbbb":e.colors.mismatch:"type"===i?"ordinalNumeric"===t.type&&"number"===g(n)?e.colors.ordinalNumeric:"binary0"!==t.type||!t.uniqueValues||n!==t.uniqueValues[0]&&n!==t.uniqueValues[1]?"ordinalNumeric"!==t.type&&"nominalText"!==t.type||!n||-1===t.uniqueValues.indexOf(n.split(t.mvDelimiter)[0])?e.colors[g(n)]:e.colors[t.type]:n===t.uniqueValues[0]?e.colors.binary0:e.colors.binary1:void 0},e.assignIndexAndFile=function(n,i){n.editIndex=i,e.fileForArrowIndexChange=n},t.keydown(function(n){e.$apply(function(i){27===n.keyCode&&i.files.forEach(function(e){e.editIndex=null}),37===n.keyCode&&e.fileForArrowIndexChange&&e.fileForArrowIndexChange.editIndex>0&&(n.preventDefault(),e.fileForArrowIndexChange.editIndex--),39===n.keyCode&&e.fileForArrowIndexChange&&e.fileForArrowIndexChange.editIndex<e.fileForArrowIndexChange.data.length-1&&(n.preventDefault(),e.fileForArrowIndexChange.editIndex++)})}),e.numberWithValue=function(e,n){return e.data.filter(function(e){return null!==e[n.key]&&void 0!==e[n.key]&&""!==e[n.key]}).length};var r=function(e){return"string"==typeof e},o=function(e){return"[object Array]"==e.toString()},d=function(e){return"number"==typeof e||RegExp("^\\d*$").test(e)},s=function(e){return null!==e&&"object"==typeof e},u=function(e){return!isNaN(e.replace(",","."))},p=function(e){var n=RegExp("^[-]\\d\\d\\d\\d($)|([-](0[0-9]|1[012]|[0-9])[-](0[0-9]|[12][0-9]|3[01]|[0-9])$)");return!!n.test(e)},c=function(e){var n=e.split(",");return 2!==n.length?!1:!(!u(n[0])||!u(n[1]))},f=function(e){return 0===e.indexOf("https://")||0===e.indexOf("http://")||0===e.indexOf("www.")},g=function(e){return"undefined"==typeof e||null===e||0===e.length?"null":s(e)?"object":o(e)?"array":d(e)&&4===e.length?"YYYY":d(e)?"number":f(e)?"url":p(e)&&4===e.length?"YYYY":p(e)&&7===e.length?"YYYYMM":p(e)?"date":u(e)?"number":c(e)?"latlong":r(e)?"text":null}}}}}),angular.module("palladio").run(["$templateCache",function(e){e.put("partials/palladio-metaview-component/template.html",'<div id="main">\n	<div id="table-histograms" class="center-block container-fluid">\n		<div class="table-histogram row" ng-repeat="file in files">\n			<div class="col-md-2">\n				<span class="pull-right">{{file.label}}</span>\n			</div>\n			<div class="col-md-8">\n				<div \n					style="width: {{85 * file.data.length / maxRecords}}%; background-color: #D3D3D3; height: 10px; margin-top: 5px; display: inline-block">\n				</div>\n				<span style="font-weight: lighter; font-size: smaller">{{file.data.length}} records</span>\n			</div>\n		</div>\n	</div>\n	<div class="clearfix" style="height:50px"></div>\n	<div id="tables" \n			style="margin-bottom: 2px; height: 100%; padding-left: 30px;">\n		<div class="table-display" ng-repeat="file in files"\n			style="vertical-align:top; margin-right: 30px;"\n			ng-init="sortModes=[\'Map errors and gaps\',\'Map by data types\',\'Sort by values\']; file.sortMode = sortModes[0]; sortFields(file); file.displayType = true;">\n			<div class="table-header pull-left" style="margin-bottom: 7px; overflow:hidden; white-space: nowrap; display: inline-block; clear: both;">\n				<span class="labels" style="width:263px; display:inline-block">\n					<span class="table-label" style="font-weight: strong; font-size: larger">{{file.label}}</span>\n				</span>\n				<span style="width: 35px; padding: 5px; display: inline-block;">\n					<!--<input type="checkbox" \n						ng-model="file.displayType"\n						style="height: 16px; width: 16px;">\n					</input>-->\n				</span>\n				<span>\n					<span ng-repeat="mode in sortModes" style="margin-left: 10px; margin-right: 10px"\n						ng-style="{ \'color\': mode === file.sortMode ? \'#bbbbbb\' : \'#68ABE5\' }"\n						ng-click="file.sortMode = mode; file.sortMode === sortModes[2] ? file.editIndex = null : null; sortFields(file);">\n						{{mode}}\n					</span>\n				</span>\n			</div>\n			<div class="dimension pull-left" ng-repeat="field in file.fields"\n				style="overflow:hidden; white-space: nowrap; margin-bottom: 2px; height: 35px; display: inline-block; clear: both; left: -30px;">\n				<div style="height: 35px; width: 300px; display: inline-block; left: 0px;">\n					<div class="dimension-main" style="height: 35px; width: 263px; background-color: #eeeeee; padding: 5px; font-weight: lighter; display: inline-block;">\n						<div style="left: 5px; background-color: #eeeeee; padding-left: 5px; padding-right: 5px; border-radius: 4px"\n							ng-style="{ position: calcPosition(file) }">\n							<span class="pull-left" style="margin-top: 3px">{{field.description}}{{field.mvDelimiter ? \' (M)\' : \'\'}}</span>\n						</div>\n						<!--<span class="dimension-specials pull-right">\n							<div class="special-character" ng-repeat="special in field.special"\n								style="height: 25px; width: 25px; display: inline-block; margin-right: 2px; text-align: center; font-size: larger; font-weight: strong; border-radius: 4px;"\n								ng-style="{ \'background-color\': field.unassignedSpecialChars.indexOf(special) !== -1 ? \'#bbbbbb\' : \'#EC5D57\' }">\n								{{special}}\n							</div>\n						</span>-->\n					</div>\n					<div style="width: 35px; height:35px; display: inline-block; margin-left: -2px; padding: 5px";\n						ng-style="{ \'background-color\' : file.displayType ? colors[field.type] : \'#eeeeee\' }"\n						data-toggle="tooltip" data-placement="top" title="{{typeTexts[field.type] ? typeTexts[field.type] : \'not found\'}}"\n						class="dimension-type">\n						<span class="pull-left"\n							style="width: 25px; font-weight: lighter; margin-top: 3px; text-align: center;"\n							ng-style="{ color: file.displayType ? textColors[field.type] : \'#444444\' }">\n							{{numberWithValue(file, field)}}\n						</span>\n					</div>\n				</div>\n				<div style="height: 35px; display: inline-block; margin-left: -2px">\n					<span ng-show="file.editIndex !== null && file.editIndex !== undefined"\n						style="height: 35px; display: inline-block; width: 200px; position: relative; float: left;"\n						ng-style="{ left: file.editIndex*4 }">\n						<input type="text" ng-model="file.data[file.editIndex][field.key]"\n							disabled\n							style="width:200px; margin:0px; height: 35px;"\n							ng-focus="clearArrowEffect()"\n							ng-change="field.sortedValues[file.editIndex].color = colorCalc(file.data[file.editIndex][field.key], file.sortMode === sortModes[0] ? \'edit\' : \'type\', field)"></input>\n					</span>\n					<div style="height:35px; display: inline-block"\n						ng-style="{ \'margin-left\': file.editIndex !== null && file.editIndex !== undefined ? \'-200px\' : \'0px\' }">\n						<div ng-repeat="obj in field.sortedValues"\n							style="height: 35px; margin-right: 1px; display: inline-block;"\n							ng-style="{ width: $index === file.editIndex ? \'200px\' : 3 + \'px\', \'background-color\': $index === file.editIndex ? \'white\' : obj.color }"\n							ng-click="file.sortMode !== sortModes[2] ? assignIndexAndFile(file, $index) : null">\n						</div>\n						<div style="height: 35px; margin-right: 1px; width:200px; display: inline-block;"></div>\n					</div>\n				</div>\n			</div>\n			<div class="pull-left" style="height: 30px; width: 100%;"></div>\n		</div>\n	<div>\n</div>')}]);